"use strict";require(["config"],function(){require(["jquery","jquery.cookie"],function(){var k=$(".amount span"),o=$(".cart_item"),e=void 0,r=void 0,d=0,h=0;if($.cookie("sid")){e=$.cookie("sid").split(","),r=$.cookie("value").split(","),$.ajax({url:"http://10.31.155.77/work/my_program/yhd/php/cart.php",dataType:"json",data:{id:e}}).done(function(e){var i="",a=!0,c=!1,t=void 0;try{for(var n,l=e[Symbol.iterator]();!(a=(n=l.next()).done);a=!0){var s=n.value;i+='\n                <li class="item">\n                <div class="cart_prod">\n                  \n                    <a href="javascript:;" class="check_all'+($.cookie("bx")?""==$.cookie("bx")?(h+=s.price*r[d]," checked"):0<=$.cookie("bx").split(",").indexOf(s.sid)?"":(h+=s.price*r[d]," checked"):(h+=s.price*r[d]," checked"))+'">\n                        <i class="iconfont"></i>\n                    </a>\n                    <a href="" target="_blank" class="item_pic">\n                        <img class="mainCart scrollLoading" src="'+s.url+'">  \n                    </a>\n                \n                    <a href="" target="_blank" class="item_tit ">\n                        <span class="fresh_tag">生鲜</span>\n                        '+s.title+'\n                    </a>\n\n                    <div class="item_price">\n                        <p> '+s.price+' </p>\n                    \n                    </div>\n                   \n                    <div class="item_num">\n                        <div class="num_act clearfix">\n                            <a href="javascript:;" class="minus">−</a>\n                            <input type="text" class="input" value="'+r[d]+'">\n                            <a href="javascript:;" class="add">+</a>\n                        </div>\n                    </div>\n                    \n                    <div class="item_amount">\n                        <div class="item_a_money"> '+s.price*r[d]+' </div>\n                        \n                    </div>\n                    \n                    <div class="item_act">\n                        <div class="item_act">\n                        <a href="javascript:;" class="collect_btn" title="收藏"></a>\n                            <i class="iconfont add"></i>\n                            </a> \n                            <a href="javascript:;" class="del_btn"></a>\n                                <i class="iconfont del"></i>\n                            </a>\n                        </div>\n            \n                    </div>\n                </div>\n                </li>\n                ',d++}}catch(e){c=!0,t=e}finally{try{!a&&l.return&&l.return()}finally{if(c)throw t}}d=0,o.html(i),k.html("￥"+h)}),o.on("click",function(e){var i=0;if("iconfont del"==e.target.className){var a=$(e.target).index(".del"),c=void 0,t=void 0;$(".item").eq(a).remove(),$(".item_a_money").each(function(){i+=Number($(this).html())}),k.html("￥"+i),(c=$.cookie("sid").split(",")).splice(a,1),$.cookie("sid",c,{expires:7}),(t=$.cookie("value").split(",")).splice(a,1),$.cookie("value",t,{expires:7})}else if("add"==e.target.className){var n=$(e.target).index("a.add"),l=void 0,s=void 0,o=0;99<=(l=$(".input").eq(n).val())?l=99:l++,$(".input").eq(n).val(l),(s=$.cookie("value").split(",")).splice(n,1,l),$.cookie("value",s,{expires:7});var r=void 0;(r=$.cookie("value").split(",")).splice(n,1,l),$.cookie("value",r),$(".item_a_money").eq(n).html(l*$(".item_price p").eq(n).html()),$(".item").has(".checked").find(".item_a_money").each(function(){o+=Number($(this).html())}),$(".amount span").html("¥ "+o)}else if("minus"==e.target.className){var d=$(e.target).index(".minus"),h=void 0,m=void 0,p=0;(h=$(".input").eq(d).val())<=1?h=1:h--,$(".input").eq(d).val(h),(m=$.cookie("value").split(",")).splice(d,1,h),$.cookie("value",m,{expires:7});var v=void 0;(v=$.cookie("value").split(",")).splice(d,1,h),$.cookie("value",v),$(".item_a_money").eq(d).html(h*$(".item_price p").eq(d).html()),$(".item").has(".checked").find(".item_a_money").each(function(){p+=Number($(this).html())}),$(".amount span").html("¥ "+p)}}),o.on("input",function(e){if("input"==e.target.className){var i=$(e.target).index(".input"),a=void 0,c=void 0,t=0;99<(a=$(".input").eq(i).val())?a=99:a<1&&(a=1),$(".input").eq(i).val(a),(c=$.cookie("value").split(",")).splice(i,1,a),$.cookie("value",c),console.log(),$(".item_a_money").eq(i).html(a*$(".item_price p").eq(i).html()),$(".item").has(".checked").find(".item_a_money").each(function(){t+=Number($(this).html())}),$(".amount span").html("¥ "+t)}}),$.cookie("bx")?""==$.cookie("bx")?$(".check_all:first").addClass("checked"):$(".check_all:first").removeClass("checked"):$.cookie("bx","",{expires:7});var n=[];$(".cart_content").on("click",function(e){var i=$(".check_all").not(".check_all:first"),a=void 0;if("iconfont"===e.target.className){var c=0,t=$(e.target).index(".check_all .iconfont");i.eq(t-1).toggleClass("checked"),$(".item").has(".checked").find(".item_a_money").each(function(){c+=Number($(this).html())}),$(".amount span").html("¥ "+c),i.length==$(".cart_list .checked").length?$(".check_all:first").addClass("checked"):$(".check_all:first").removeClass("checked"),"check_all checked"==i.eq(t-1).attr("class")?(a=$.cookie("sid").split(","),""==(n=$.cookie("bx").split(","))&&(n=[]),b_index=n.indexOf(a[t-1]),n.splice(b_index,1)):(a=$.cookie("sid").split(","),""==(n=$.cookie("bx").split(","))&&(n=[]),n.push(a[t-1])),$.cookie("bx",n)}}),$(".check_all:first").on("click",function(){var e=0,i=$(".check_all").not(".check_all:first"),a=$(".check_all:first");return a.toggleClass("checked"),"check_all checked"===a.attr("class")?i.each(function(){$(this).addClass("checked"),$.cookie("bx","")}):i.each(function(){$(this).removeClass("checked"),$.cookie("bx",[$.cookie("sid")])}),$(".item").has(".checked").find(".item_a_money").each(function(){e+=Number($(this).html())}),$(".amount span").html("¥ "+e),!1})}})});